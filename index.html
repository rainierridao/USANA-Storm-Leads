<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>USANA Storm - Raffle Entry</title>
  <style>
    /* Compact Form Header */
    .form-header {
      background-color: rgba(255, 255, 255, 0.95);
      color: #1b4f72;
      padding: 12px 14px;
      border-radius: 16px 16px 0 0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
    }
    
    .form-header h1 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      color: #7b7b7b;
    }
    
    /* Icon Logout Button */
    .logout-btn {
      background: none;
      border: none;
      color: #7b7b7b;
      padding: 5px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.3s ease;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 0px;
    }
    
    .logout-btn:hover {
      background-color: rgba(46, 134, 222, 0.1);
    }
    
    .logout-icon {
      transition: transform 0.3s ease;
    }
    
    .logout-btn:hover .logout-icon {
      transform: translateX(2px);
    }
    
    /* Adjust body padding */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom right, #2e86de, #1b4f72);
      min-height: 100vh;
      background-image: url('https://vcdn1-english.vnecdn.net/2023/08/31/woman-applying-face-cream-1693-8663-8338-1693499675.jpg?w=680&h=0&q=100&dpr=2&fit=crop&s=wmv-QhEUohoN1VdALBeRqQ');
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* Form container */
    .overlay {
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
      max-width: 460px;
      width: 90%;
      transition: all 0.3s ease;
      margin: 20px 0;
    }
    
    .form-content {
      padding: 0 20px 25px;
    }
    
    h2 {
      text-align: center;
      color: #4461ef;
      font-size: 30px;
      margin-bottom: 5px;
      margin-top: 15px;
    }
    
    p.subtext {
      text-align: center;
      color: #555;
      font-size: 13px;
      margin-bottom: 18px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: 600;
      color: #333;
      font-size: 14px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border-radius: 8px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      font-size: 14px;
      box-sizing: border-box;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #2e86de;
      box-shadow: 0 0 4px rgba(46, 134, 222, 0.3);
    }

    button {
      width: 100%;
      margin-top: 18px;
      padding: 10px;
      background-color: #4461ef;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #2a3d99;
    }

    /* Email field container */
    .email-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .email-container input[type="email"] {
      flex: 1;
    }

    .skip-email {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 13px;
      color: #555;
    }

    .skip-email input {
      width: auto;
      margin: 0;
    }

    /* Loading overlay styles */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .loading-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .loader {
      width: 48px;
      height: 48px;
      border: 5px solid #2e86de;
      border-bottom-color: transparent;
      border-radius: 50%;
      display: inline-block;
      box-sizing: border-box;
      animation: rotation 1s linear infinite;
    }

    @keyframes rotation {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    /* Success message styles */
    .success-message {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1001;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      text-align: center;
      padding: 20px;
    }

    .success-message.active {
      opacity: 1;
      pointer-events: all;
    }

    .success-icon {
      font-size: 60px;
      color: #2e86de;
      margin-bottom: 20px;
      animation: bounce 0.5s;
    }

    .success-text {
      font-size: 22px;
      color: #7b7b7b;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .success-subtext {
      font-size: 16px;
      color: #555;
      margin-bottom: 25px;
      max-width: 300px;
    }

    .back-button {
      padding: 10px 25px;
      background-color: #4461ef;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .back-button:hover {
      background-color: #2a3d99;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
      }
      40% {
        transform: translateY(-20px);
      }
      60% {
        transform: translateY(-10px);
      }
    }

    /* Confetti styles */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: #f00;
      opacity: 0;
      z-index: 1002;
      animation: confetti-fall 3s ease-in-out forwards;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }
       
    /* Date input styling */
    #bday {
      width: 100%;
      height: 36px;
      padding: 6px 10px;
      box-sizing: border-box;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      h2 {
        font-size: 22px;
      }
      
      .form-header h1 {
        font-size: 14px;
      }
      
      button {
        padding: 8px;
        font-size: 14px;
      }
      
      /* Date input styling */
      #bday {
      width: 100px;
      height: 36px;
      padding: 6px 10px;
      box-sizing: border-box;
    }
    }

    @media (max-width: 375px) {
      h2 {
        font-size: 22px;
      }
    }

    /* Modal styling */
    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 500px;
      border-radius: 8px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: black;
    }
        
    .modal-content input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      font-size: 14px;
      box-sizing: border-box;
    }

    .modal-content button {
      width: 100%;
      padding: 10px;
      background-color: #4461ef;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .modal-content button:hover {
      background-color: #2a3d99;
    }
  </style>
</head>
<body>
  <div class="overlay">
    <!-- Compact Form Header -->
    <div class="form-header">

      <div id="eventInfo">Event Title</div>
      <button class="logout-btn" id="logoutBtn" title="Logout">
        <span class="logout-icon">→</span>
      </button>
    </div>

    <div class="form-content">
      <h2>✨ Glow & Win – Raffle ✨</h2>
      <p class="subtext">Enter now for a chance to win a premium skincare gift!</p>
      <form id="raffleForm">
        <label for="name">Full Name</label>
        <input type="text" id="name" name="name" required />

        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
          <div style="flex: 1;">
            <label for="bday">Birthday</label>
            <input type="date" id="bday" name="bday" required />
          </div>
          <div style="flex: 1;">
            <label for="contact">Contact Number</label>
            <input type="tel" id="contact" name="contact" required />
          </div>
        </div>

        <label for="email">Email Address</label>
        <div class="email-container">
          <input type="email" id="email" name="email" />
          <div class="skip-email">
            <input type="checkbox" id="noEmail" name="noEmail">
            <label for="noEmail">Skip Email</label>
          </div>
        </div>

        <label for="address">Address</label>
        <textarea id="address" name="address" rows="2" required></textarea>

        <label for="work">Nature of Work</label>
        <select id="work" name="work" required onchange="checkOtherOption(this)">
          <option value="">Select...</option>
          <option value="Call Center Agent">Call Center Agent</option>
          <option value="Content Creator">Content Creator</option>
          <option value="Engineer">Engineer</option>
          <option value="Entrepreneur">Entrepreneur</option>
          <option value="Fitness Coach">Fitness Coach</option>
          <option value="Freelancer">Freelancer</option>
          <option value="Healthcare Worker">Healthcare Worker</option>
          <option value="Housewife">Housewife</option>
          <option value="Marketing">Marketing</option>
          <option value="OFW">OFW (Overseas Filipino Worker)</option>
          <option value="Office Worker">Office Worker</option>
          <option value="Real Estate Agent">Real Estate Agent</option>
          <option value="Retail Staff">Retail Staff</option>
          <option value="Retired">Retired</option>
          <option value="Sales Representative">Sales Representative</option>
          <option value="Service Crew">Service Crew</option>
          <option value="Student">Student</option>
          <option value="Teacher">Teacher</option>
          <option value="Working Mom">Working Mom</option>
          <option value="VA">VA</option>
          <option value="Others">Others, Please specify</option>
        </select>

        <button type="submit">Submit Entry</button>
      </form>
    </div>
  </div>

  <!-- Loading overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loader"></div>
  </div>

  <!-- Success message -->
  <div class="success-message" id="successMessage">
    <div class="success-icon">🎉</div>
    <div class="success-text">Entry Submitted!</div>
    <div class="success-subtext">Thank you for participating in our raffle. Good luck!</div>
    <button class="back-button" id="backButton" style="width: 200px;">Back to Form</button>
  </div>

  <!-- Other Occupation Modal -->
  <div id="otherOccupationModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h3>Please specify your occupation</h3>
      <input type="text" id="otherOccupation" placeholder="Enter your occupation">
      <button onclick="saveOtherOccupation()">Save</button>
    </div>
  </div>

  <!-- Alternative more camouflaged version -->
  <div style="position: fixed; bottom: 0; right: 0; width: 50px; height: 50px;">
    <a href="Admin Dashboard.html" style="display: block; width: 100%; height: 100%; opacity: 0.01;" title="Admin Dashboard"></a>
  </div>

  <script>
  
      // Form validation logger
      function logFormValidation(field, isValid, message) {
        const timestamp = new Date().toLocaleTimeString();
        const status = isValid ? '✅ PASS' : '❌ FAIL';
        console.log(`[${timestamp}] Validation: ${field} - ${status} - ${message}`);
      }
      
      // Form data logger
      function logFormData(formData) {
        console.group('Form Data Submitted');
        console.log('📅 Timestamp:', new Date().toLocaleString());
        for (const [key, value] of Object.entries(formData)) {
          console.log(`📋 ${key}:`, value || '(empty)');
        }
          console.groupEnd();
          }
          
          // Field change logger
          function setupFieldLogging() {
            const form = document.getElementById('raffleForm');
            const fields = form.querySelectorAll('input, textarea, select');
            
            fields.forEach(field => {
              field.addEventListener('change', function() {
                const timestamp = new Date().toLocaleTimeString();
                console.log(`[${timestamp}] Field changed: ${this.name} =`, this.value);
              });
              
              field.addEventListener('blur', function() {
                const timestamp = new Date().toLocaleTimeString();
                console.log(`[${timestamp}] Field blurred: ${this.name} =`, this.value);
              });
            });
          }
  
  
  
  
      // Update the header content with your existing script
      document.addEventListener('DOMContentLoaded', function() {
        const eventInfo = document.getElementById('eventInfo');
        const logoutBtn = document.getElementById('logoutBtn');

        setupFieldLogging();

        // Check if we have an authenticated event
          const currentEvent = sessionStorage.getItem('currentEvent');
          
          if (!currentEvent) {
            window.location.href = window.location.pathname.includes('index.html') ? 
            'event-selection.html' : '../event-selection.html';
            return;
          }
            
            // Display the current event
            eventInfo.innerHTML = `<h1>${currentEvent}</h1>`;
            
            // Logout button functionality
            logoutBtn.addEventListener('click', function() {
              sessionStorage.removeItem('currentEvent');
              window.location.href = window.location.pathname.includes('index.html') ? 
              'event-selection.html' : '../event-selection.html';
            });
            
            // Initialize other occupation modal
            document.getElementById('work').addEventListener('change', function() {
              checkOtherOption(this);
              
            });
            console.log('Form initialized and ready for input');
            });
            
            // Form submission handler
            document.getElementById('raffleForm').addEventListener('submit', async function(e) {
              e.preventDefault();
              
              // Get field references
              const emailField = document.getElementById('email');
              const noEmailCheckbox = document.getElementById('noEmail');
              const phoneField = document.getElementById('contact');
              
              // Validate form
              if (!noEmailCheckbox.checked && !emailField.value) {
                const message = 'Email required but not provided';
                logFormValidation('email', false, message);
                alert('Please enter your email address or check the "Skip Email" box');
                return;
              }
                
                if (!noEmailCheckbox.checked) {
                  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                  if (!emailRegex.test(emailField.value)) {
                    const message = `Invalid email format: ${emailField.value}`;
                    logFormValidation('email', false, message);
                    alert('Please enter a valid email address');
                    return;
                  }
                    logFormValidation('email', true, 'Valid email format');
                    }
                    
                    // Phone validation
                    const phoneRegex = /^[0-9\-\+]{9,15}$/;
                    if (!phoneRegex.test(phoneField.value)) {
                      const message = `Invalid phone format: ${phoneField.value}`;
                      logFormValidation('phone', false, message);
                      alert('Please enter a valid phone number (9-15 digits, may include + or -)');
                      return;
                    }
                      logFormValidation('phone', true, 'Valid phone format');
                      
                      // Validate required fields
                      const requiredFields = ['name', 'bday', 'contact', 'address', 'work'];
                      for (const fieldId of requiredFields) {
                        const field = document.getElementById(fieldId);
                        if (!field.value.trim()) {
                          const message = `Required field empty: ${field.name}`;
                          logFormValidation(field.name, false, message);
                          alert(`Please fill in the ${field.placeholder || field.name} field`);
                          field.focus();
                          return;
                        }
                          logFormValidation(field.name, true, 'Field has value');
                          }
                          
                          // Show loading overlay
                          document.getElementById('loadingOverlay').classList.add('active');
                          
                          try {
                            // Prepare form data (still send it, but don't wait for response)
    const formData = {
      name: document.getElementById('name').value.trim(),
      bday: document.getElementById('bday').value,
      contact: document.getElementById('contact').value.trim(),
      email: document.getElementById('noEmail').checked ? '' : document.getElementById('email').value.trim(),
      address: document.getElementById('address').value.trim(),
      work: document.getElementById('work').value.trim(),
      event: document.getElementById('eventInfo').textContent.trim(),
      timestamp: new Date().toISOString(),
      action: "submitForm"
    };
    
    const scriptUrl = 'https://script.google.com/macros/s/AKfycbzWznDJ681M3zYOzNHP00Gv-NP3mxjFUhIlE-5XBeHpbRv35vTFkhRakhTih2z0VaGtkQ/exec';
    
    // Fire-and-forget the submission (don't await it)
                            fetch(`${scriptUrl}?${new URLSearchParams(formData).toString()}`, {
                              method: 'GET',
                              redirect: 'follow',
                              headers: {
                                'Content-Type': 'text/plain'
                              }
                            }).catch(error => {
                              console.error('Submission error (ignored):', error);
                            });
                            
                          } catch (error) {
                            console.error('Error preparing submission (ignored):', error);
                          }
                          
                          // Show success message after 2 seconds regardless of submission result
                          setTimeout(() => {
    document.getElementById('loadingOverlay').classList.remove('active');
    document.getElementById('successMessage').classList.add('active');
    this.reset();
    document.getElementById('noEmail').checked = false;
  }, 2000);
});

    
                          // Other occupation modal functions
                          function checkOtherOption(select) {
                            if (select.value === "Others") {
                              document.getElementById("otherOccupationModal").style.display = "block";
                              document.getElementById("otherOccupation").focus();
                            }
                              }
                              
                              function closeModal() {
                                document.getElementById("otherOccupationModal").style.display = "none";
                              }
                              
                              function saveOtherOccupation() {
                                const otherValue = document.getElementById("otherOccupation").value.trim();
                                if (otherValue) {
                                  const select = document.getElementById("work");
                                    let exists = false;
                                    
                                    // Check if option already exists
                                      for (let i = 0; i < select.options.length; i++) {
                                        if (select.options[i].value === otherValue) {
                                          exists = true;
                                          break;
                                        }
                                          }
                                          
                                          // Add new option if it doesn't exist
    if (!exists) {
      const newOption = new Option(otherValue, otherValue);
      select.add(newOption);
    }
    
    select.value = otherValue;
    document.getElementById("otherOccupation").value = "";
  }
  closeModal();
}

// Email checkbox handler
document.getElementById('noEmail').addEventListener('change', function() {
  const emailField = document.getElementById('email');
  if (this.checked) {
    emailField.disabled = true;
    emailField.placeholder = 'Skipped (no email)';
    emailField.value = '';
  } else {
    emailField.disabled = false;
    emailField.placeholder = 'Enter your email address';
  }
});

// Back button handler
document.getElementById('backButton').addEventListener('click', function() {
  document.getElementById('successMessage').classList.remove('active');
});

// Confetti animation
function createConfetti() {
  const colors = ['#2e86de', '#1b4f72', '#feca57', '#ff6b6b', '#5f27cd', '#1dd1a1'];
  const confettiContainer = document.createElement('div');
  confettiContainer.style.position = 'fixed';
  confettiContainer.style.top = '0';
  confettiContainer.style.left = '0';
  confettiContainer.style.width = '100%';
  confettiContainer.style.height = '100%';
  confettiContainer.style.pointerEvents = 'none';
  confettiContainer.style.zIndex = '1002';
  
  document.body.appendChild(confettiContainer);
  
  for (let i = 0; i < 100; i++) {
    const confetti = document.createElement('div');
    confetti.className = 'confetti';
    confetti.style.left = Math.random() * 100 + 'vw';
    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.width = Math.random() * 10 + 5 + 'px';
    confetti.style.height = Math.random() * 10 + 5 + 'px';
    confetti.style.animationDuration = Math.random() * 2 + 2 + 's';
    confetti.style.animationDelay = Math.random() * 2 + 's';
    
    confettiContainer.appendChild(confetti);
    
    setTimeout(() => {
      confetti.remove();
    }, 5000);
  }
  
  setTimeout(() => {
    confettiContainer.remove();
  }, 5000);
}

// Close modal when clicking outside
window.addEventListener('click', function(event) {
  const modal = document.getElementById('otherOccupationModal');
  if (event.target === modal) {
    closeModal();
  }
});
  </script>
</body>
</html>